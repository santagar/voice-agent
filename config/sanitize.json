[
  {
    "description": "API keys (api_key, x-api-key, etc.)",
    "pattern": "(x[-_]api[-_]key|api[-_]?key)\\s*[:=]\\s*[\"']?[A-Za-z0-9_\\-]{8,}[\"']?",
    "flags": "gi",
    "replacement": "$1=[OCULTO]"
  },
  {
    "description": "JWT / Bearer tokens",
    "pattern": "(bearer\\s+|token\\s*[:=]\\s*)[A-Za-z0-9_\\-\\.]{10,}",
    "flags": "gi",
    "replacement": "$1[OCULTO]"
  },
  {
    "description": "Access tokens y Refresh tokens",
    "pattern": "(access_token|refresh_token|id_token)\"?\\s*[:=]\\s*\"[A-Za-z0-9._\\-]{10,}\"",
    "flags": "gi",
    "replacement": "$1: \"[TOKEN OCULTO]\""
  },
  {
    "description": "Sesiones y cookies sensibles",
    "pattern": "(sessionid|sid|csrf_token|xsrf[-_]token|auth_token)\"?\\s*[:=]\\s*\"[A-Za-z0-9._\\-]{8,}\"",
    "flags": "gi",
    "replacement": "$1: \"[SESIÓN OCULTA]\""
  },
  {
    "description": "Tokens en query params (?token=..., ?code=..., ?otp=...)",
    "pattern": "(token|code|otp|one_time_code)=([A-Za-z0-9._\\-]{4,})",
    "flags": "gi",
    "replacement": "$1=[OCULTO]"
  },
  {
    "description": "Passwords (contraseña / password / passphrase)",
    "pattern": "(contraseñ[aá]|password|passphrase)\\s*[:=]\\s*[\"']?([^\\s\"']+)[\"']?",
    "flags": "gi",
    "replacement": "$1: [OCULTA]"
  },
  {
    "description": "Secret keys genéricas",
    "pattern": "(secret[_\\s-]?key|secret|clave\\s+secreta)\\s*[:=]\\s*[\"']?([^\\s\"']+)[\"']?",
    "flags": "gi",
    "replacement": "$1: [OCULTA]"
  },
  {
    "description": "Private keys (pem completas)",
    "pattern": "-----BEGIN\\s+PRIVATE\\s+KEY-----[\\s\\S]+?-----END\\s+PRIVATE\\s+KEY-----",
    "flags": "gi",
    "replacement": "[CLAVE PRIVADA OCULTA]"
  },
  {
    "description": "Postgres connection string",
    "pattern": "postgresql?:\\/\\/[^\\s\"']+",
    "flags": "gi",
    "replacement": "postgresql://[CONN_STRING_OCULTO]"
  },
  {
    "description": "MySQL connection string",
    "pattern": "mysql:\\/\\/[^\\s\"']+",
    "flags": "gi",
    "replacement": "mysql://[CONN_STRING_OCULTO]"
  },
  {
    "description": "MongoDB connection string",
    "pattern": "mongodb(\\+srv)?:\\/\\/[^\\s\"']+",
    "flags": "gi",
    "replacement": "mongodb://[CONN_STRING_OCULTO]"
  },
  {
    "description": "Infra interna (Kubernetes, VPC, subnets, security groups, etc.)",
    "pattern": "(kubernetes\\s+cluster|cluster\\s+de\\s+kubernetes|vpc\\s+privad[ao]|vpc\\s+peering|subnet|subred|security\\s+group|grupo\\s+de\\s+seguridad|rds\\s+instance|instancia\\s+rds|redis\\s+cluster|s3\\s+bucket|bucket\\s+de\\s+s3)",
    "flags": "gi",
    "replacement": "[DETALLE TÉCNICO INTERNO OMITIDO]"
  },
  {
    "description": "Dominios internos (.local / .internal)",
    "pattern": "\\bhttps?:\\/\\/[^\\s\"']+\\.(local|internal)(:[0-9]{2,5})?[^\\s\"']*",
    "flags": "gi",
    "replacement": "https://[DOMINIO_INTERNO_OCULTO]"
  },
  {
    "description": "Emails de usuario",
    "pattern": "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}",
    "flags": "g",
    "replacement": "[EMAIL OCULTO]"
  },
  {
    "description": "Teléfonos (internacionales o nacionales)",
    "pattern": "\\+?\\d[\\d\\s\\-]{7,}\\d",
    "flags": "g",
    "replacement": "[TELÉFONO OCULTO]"
  },
  {
    "description": "DNI/NIF/NIE (aprox)",
    "pattern": "\\b\\d{7,8}-?[A-Za-z]\\b",
    "flags": "g",
    "replacement": "[DOC_ID OCULTO]"
  },
  {
    "description": "IBAN europeo",
    "pattern": "\\b[A-Z]{2}\\d{2}[A-Z0-9]{11,30}\\b",
    "flags": "g",
    "replacement": "[IBAN OCULTO]"
  },
  {
    "description": "Números de tarjeta de crédito (detección amplia)",
    "pattern": "\\b(?:\\d[ -]*?){13,19}\\b",
    "flags": "g",
    "replacement": "[TARJETA OCULTA]"
  },
  {
    "description": "IP interna 10.x.x.x",
    "pattern": "\\b10\\.(\\d{1,3}\\.){2}\\d{1,3}\\b",
    "flags": "g",
    "replacement": "[IP INTERNA]"
  },
  {
    "description": "IP interna 192.168.x.x",
    "pattern": "\\b192\\.168\\.\\d{1,3}\\.\\d{1,3}\\b",
    "flags": "g",
    "replacement": "[IP INTERNA]"
  },
  {
    "description": "IP interna 172.16-31.x.x",
    "pattern": "\\b172\\.(1[6-9]|2\\d|3[0-1])\\.\\d{1,3}\\.\\d{1,3}\\b",
    "flags": "g",
    "replacement": "[IP INTERNA]"
  }
]

